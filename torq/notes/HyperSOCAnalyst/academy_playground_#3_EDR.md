# Torq HyperSOC – EDR Alert (CrowdStrike Detection)

## 1. Summary

This live lab simulated a **CrowdStrike EDR alert** handled within **Torq’s HyperSOC** environment, where the AI analyst **Socrates** autonomously investigates, enriches, and remediates the case.

The exercise showcased how to delegate a case to Socrates in **auto-pilot mode**, supervise the automatically generated **Actionplan**, validate all investigation steps, and then finish remediation collaboratively in **co-pilot mode**.

---

## 2. Objective

* Generate an Actionplan from a CrowdStrike runbook.
* Assign the case to **Socrates** for autonomous investigation.
* Validate enrichment of IOCs (file hash and IP address).
* Guide Socrates to execute final remediation actions.
* Resolve the case with a properly documented outcome.

---

## 3. Investigation Workflow (Steps Completed)

### Step 1. Generate Actionplan

* Navigated to **Investigate → Runbooks**.
* Located and opened the **CrowdStrike Runbook**.
* Reviewed all runbook steps outlining detection triage, IOC enrichment, and remediation logic.
* On the right panel, clicked **Generate Actionplan** to let Socrates create a structured plan of actions.
* Verified that each action listed:

  * **Prompt:** description of the task to perform
  * **Method:** logic Socrates will use
  * **Tool:** specific Torq workflow to execute
* After confirming accuracy, clicked **Save Actionplan** to preserve it.
  *(Without saving, Socrates cannot execute it.)*

---

### Step 2. Assign Case to Socrates

* Navigated to **Investigate → Cases**.
* Located case **“CrowdStrike Detection – BashReverseShell”** (tag: *Playground 3*).
* Opened the case and assigned ownership to **Torq Socrates** using the Owner dropdown.
* Monitored progress under the **Socrates tab**:

  * Observed analysis initialization
  * Execution of each runbook step
  * Confirmation message:
    *“Actionplan execution ended successfully!”*

---

### Step 3. Validate Runbook Execution

Checked multiple panels to confirm proper automation flow:

| Panel             | What to Verify                           | Result                                                |
| ----------------- | ---------------------------------------- | ----------------------------------------------------- |
| **Socrates**      | Detailed sequence of investigation steps | All actions executed successfully                     |
| **Timeline**      | Automation log entries                   | Each enrichment and assignment recorded               |
| **Notes**         | Findings and evidence summaries          | Newly added note describing activity                  |
| **Case Overview** | Severity and reassignment                | Socrates changed severity, reassigned case back to me |

Then reviewed **Observables**:

* Confirmed both **File Hash** and **IP Address** present.
* Verified enrichment completed (✔ next to *Enrichment*).

If any observable was missing, instructed Socrates:

```
Enrich file hash and IP address, then add them as observables
```

---

### Step 4. Co-Pilot Remediation Phase

With Socrates having finished automated triage, switched to **co-pilot mode** to drive final remediation.

1. **Quarantine the malicious file**

   ```
   Quarantine the file
   ```

   * Verified in Timeline that containment workflow executed.

2. **Summarize investigation and remediation**

   ```
   Summarize the investigation and remediation course, and add it as a note
   ```

   * Confirmed summary note appeared under **Notes**.

3. **Resolve the case**

   ```
   Resolve the case, the resolution reason should be True Positive – Malicious – Human In The Loop, and generate resolution details
   ```

   * Verified that resolution details auto-generated by Socrates were attached to the case.
   * Checked **Overview → Resolution Reason = True Positive – Malicious – Human In The Loop**.

Case now displayed in **Resolved** section.

---

## 4. Outcome

* **AI-Driven Investigation:** Socrates executed the CrowdStrike runbook automatically end-to-end.
* **Analyst Oversight:** All steps were reviewed and validated for accuracy.
* **Remediation Complete:** File quarantined; case resolved with proper documentation.
* **Audit Trail:** Every enrichment, containment, and closure recorded in Timeline.

---

## 5. Key Learnings

1. **Auto-Pilot Mode** – Enables full autonomous case handling when Actionplans are well-defined.
2. **Co-Pilot Mode** – Allows analysts to interject targeted commands while preserving audit continuity.
3. **Actionplans as Knowledge Objects** – They ensure repeatable, consistent response to recurring detection types.
4. **End-to-End Traceability** – Every Socrates action appears in both Timeline and Notes, ensuring defensibility.
5. **Human-in-the-Loop Validation** – Even with AI autonomy, analyst verification remains vital for high-confidence closures.

---

## 6. Optional Local Simulation (Python Example)

A simple mock-up showing how an automated EDR case might be orchestrated programmatically.

```python
class SocratesAI:
    def __init__(self):
        self.timeline = []
    def execute_actionplan(self):
        self.timeline.append("Analyzed CrowdStrike alert: BashReverseShell")
        self.timeline.append("Enriched file hash and IP address")
        self.timeline.append("Changed severity to Critical and reassigned to analyst")
    def quarantine_file(self, file_name):
        self.timeline.append(f"Quarantined file: {file_name}")
    def summarize(self):
        note = (
            "Socrates investigated CrowdStrike detection, enriched IOCs, "
            "and quarantined malicious file. Case resolved as True Positive – Malicious."
        )
        self.timeline.append(note)
    def resolve_case(self, reason):
        self.timeline.append(f"Case resolved: {reason}")
        return {"resolution": reason, "timeline": self.timeline}

# Simulated execution
socrates = SocratesAI()
socrates.execute_actionplan()
socrates.quarantine_file("bash_reverse_shell.sh")
socrates.summarize()
result = socrates.resolve_case("True Positive – Malicious – Human In The Loop")

for line in result["timeline"]:
    print(line)
```

**Sample Output**

```
Analyzed CrowdStrike alert: BashReverseShell
Enriched file hash and IP address
Changed severity to Critical and reassigned to analyst
Quarantined file: bash_reverse_shell.sh
Socrates investigated CrowdStrike detection, enriched IOCs, and quarantined malicious file. Case resolved as True Positive – Malicious.
Case resolved: True Positive – Malicious – Human In The Loop
```

---

## 7. Folder Structure

```
/torq/automation-practitioner/edr-alert/
├── README.md
└── scripts/
    └── simulate_edr_case.py
```

---

## 8. Reflection

This lab demonstrated the next evolution of SOC operations — **AI-assisted autonomous response**.
By delegating structured tasks to Socrates, analysts shift from manual triage to **supervisory orchestration**, ensuring faster MTTR (Mean Time to Respond) without sacrificing control or context.
This exercise solidified practical understanding of Actionplans, runbook validation, and AI-guided remediation workflows in a modern SOAR environment.